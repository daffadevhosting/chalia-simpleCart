!function(b,a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():b.lazyLoad=a()}(this,function(){var a,b,c,d,e,f={pageUpdatedEventName:"page:updated",elements:"img[data-src], img[data-srcset], source[data-srcset], iframe[data-src], video[data-src], [data-lazyload]",rootMargin:"0px",threshold:0,maxFrameCount:10},g=[];function h(a){var b=(a="SOURCE"===a.tagName?a.parentNode:a).getBoundingClientRect();return b.bottom>0&&b.right>0&&b.left<(window.innerWidth||document.documentElement.clientWidth)&&b.top<(window.innerHeight||document.documentElement.clientHeight)}function i(a){a.removeAttribute("data-src"),a.removeAttribute("data-srcset"),a.removeAttribute("data-lazyload")}function j(){this.removeEventListener("load",j),i(this)}function k(a){var b=a.getAttribute("data-srcset"),c=a.getAttribute("data-src"),d=null!==a.getAttribute("data-lazyload");b&&(a.setAttribute("srcset",b),window.picturefill&&window.picturefill({elements:[a]})),c&&(a.src=c),d&&(a.setAttribute("data-lazyloaded",""),a.removeEventListener("load",j),i(a))}function l(e){0===c&&d.disconnect();for(var b=0;b<e.length;b++){var a=e[b];a.intersectionRatio>0&&(c--,d.unobserve(a.target),a.target.addEventListener("load",j,!1),k(a.target))}}function m(){var n;if("really-old"===e){for(n=0,c=g.length;n<c;n++)g[n]&&(k(g[n]),i(g[n]));g=[]}else if("old"===e){if(b===f.maxFrameCount){for(n=0,c=g.length;n<c;n++)if(g[n]&& void 0===g[n].lazyloaded&&h(g[n])){var o=g[n];g[n]=void 0,o.lazyloaded=!0,o.addEventListener("load",j,!1),k(o)}for(n=0;n<c;n++)void 0===g[n]&&g.splice(n,1);c=g.length,b=-1}c>0&&(b++,a=window.requestAnimationFrame(m))}else if("new"===e)for(n=0,d=new IntersectionObserver(l,{rootMargin:f.rootMargin,threshold:f.threshold}),c=g.length;n<c;n++)g[n]&& void 0===g[n].lazyloaded&&d.observe(g[n])}function n(){if("old"===e)try{cancelAnimationFrame(a)}catch(h){}else if("new"===e)try{d.disconnect()}catch(i){}c=(g=function(c){var b=[],a=0;for(b=[],a=c.length;a;)b[--a]=c[a];return b}(document.querySelectorAll(f.elements))).length,b=f.maxFrameCount,m()}return function(a){for(var b in a)a.hasOwnProperty(b)&&(f[b]=a[b]);e="addEventListener"in window&&window.requestAnimationFrame&&(document.body.getBoundingClientRect,1)?"IntersectionObserver"in window?"new":"old":"really-old",n(),f.pageUpdatedEventName&&document.addEventListener(f.pageUpdatedEventName,n,!0)}}),lazyLoad()
